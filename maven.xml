<project xmlns:j="jelly:core">
    <postGoal name="war:webapp">
        <available file="../laneweb.properties" property="laneweb.production"/>
        <copy todir="${maven.war.webapp.dir}/WEB-INF">
            <fileset dir="src/conf" includes="*.xconf"/>
            <j:choose>
                <j:when test="${laneweb.production}">
                    <filterset filtersfile="../laneweb.properties" begintoken="***" endtoken="***"/>
                </j:when>
                <j:otherwise>
                    <filterset filtersfile="project.properties" begintoken="***" endtoken="***"/>
                </j:otherwise>
            </j:choose>
        </copy>
        <copy todir="${maven.war.webapp.dir}/META-INF" file="src/conf/context.xml" overwrite="true">
            <j:choose>
                <j:when test="${laneweb.production}">
                    <filterset filtersfile="../laneweb.properties" begintoken="***" endtoken="***"/>
                </j:when>
                <j:otherwise>
                    <filterset filtersfile="project.properties" begintoken="***" endtoken="***"/>
                </j:otherwise>
            </j:choose>
        </copy>
    </postGoal>

    <preGoal name="checkstyle:report-internal">
        ${systemScope.setProperty('javax.xml.transform.TransformerFactory','com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl')}
    </preGoal>
    
</project>
