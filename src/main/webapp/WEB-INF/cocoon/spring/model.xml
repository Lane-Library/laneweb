<?xml version="1.0" encoding="UTF-8"?>
<!--$Id$-->
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">


    <bean id="org.apache.cocoon.el.ExpressionFactory"
        class="edu.stanford.irt.laneweb.model.LanewebExpressionFactory">
        <property name="expressionCompiler">
            <bean class="edu.stanford.irt.laneweb.model.LanewebExpressionCompiler"/>
        </property>
    </bean>

    <bean id="org.apache.cocoon.el.objectmodel.ObjectModelProvider"
        class="edu.stanford.irt.laneweb.model.LanewebObjectModelProvider">
        <constructor-arg ref="org.apache.cocoon.processing.ProcessInfoProvider"/>
        <constructor-arg ref="edu.stanford.irt.laneweb.user.UserDao"/>
        <constructor-arg>
            <bean class="edu.stanford.irt.laneweb.model.ProxyLinks">
                <property name="proxyRegex">
                    <list>
                        <!-- VPN 171.65.16.0 - 171.65.31.255 -->
                        <value>^171\.66\.(?:1[6-9]|2[0-9]|3[0-1])\.\S+</value>
                        <!-- hospital 171.65.44.0 - 171.65.44.255 -->
                        <value>^171\.65\.44\.\S+</value>
                        <!-- hospital 171.65.125.0 - 171.65.125.255 -->
                        <value>^171\.65\.125\.\S+</value>
                        <!-- hospital 171.65.128.0 - 171.65.199.255 -->
                        <value>^171\.65\.1(?:2[8-9]|[3-9][0-9])\.\S+</value>
                        <!-- hospital 171.65.200.0 - 171.65.255.255 -->
                        <value>^171\.65\.2[0-5][0-9]\.\S+</value>
                    </list>
                </property>
                <property name="noProxyRegex">
                    <list>
                        <value>^171\.6[4-7]\.\S+</value>
                        <!-- campus wireless 10.32.0.0 through 10.33.255.255 -->
                        <value>^10\.3[2-3]\.\S+</value>
                        <!-- library wireless 10.39.32.1 through 10.39.47.255 -->
                        <value>^10\.39\.(?:3[2-9]|4[0-7])\.\S+</value>
                    </list>
                </property>
            </bean>
        </constructor-arg>
        <constructor-arg>
            <bean class="edu.stanford.irt.laneweb.model.TemplateChooser">
                <constructor-arg value="template"/>
                <constructor-arg>
                    <!-- TODO: this should be an ordered map if more than one entry -->
                    <map>
                        <entry key="^(?:/\w+|)/bassett/raw/bassettLargerView.html"
                            value="bassettLargerView"/>
                    </map>
                </constructor-arg>
            </bean>
        </constructor-arg>
    </bean>

    <bean id="org.apache.cocoon.el.objectmodel.ObjectModel"
        class="edu.stanford.irt.laneweb.model.LanewebObjectModel" scope="request">
        <property name="initialEntries">
            <map>
                <entry key="laneweb"
                    value-ref="org.apache.cocoon.el.objectmodel.ObjectModelProvider"/>
            </map>
        </property>
    </bean>
    
    <bean id="edu.stanford.irt.laneweb.model.DefaultObjectModelAware"
        class="edu.stanford.irt.laneweb.model.DefaultObjectModelAware"
        scope="prototype" abstract="true">
        <property name="objectModel" ref="org.apache.cocoon.el.objectmodel.ObjectModel"/>
    </bean>
    
</beans>
