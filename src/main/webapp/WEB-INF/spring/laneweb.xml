<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

    <bean id="edu.stanford.irt.laneweb.ldap.LDAPDataAccess"
        class="edu.stanford.irt.laneweb.ldap.LDAPDataAccess">
        <property name="subjectSource">
            <bean class="edu.stanford.irt.laneweb.ldap.SubjectSource">
                <property name="name" value="IRT_K5"/>
            </bean>
        </property>
        <property name="ldapTemplate">
            <bean class="org.springframework.ldap.core.LdapTemplate">
                <constructor-arg>
                    <bean class="org.springframework.ldap.core.support.LdapContextSource">
                        <property name="url" value="ldap://ldap.stanford.edu/"/>
                        <property name="base" value="cn=people,dc=stanford,dc=edu"/>
                        <property name="authenticationStrategy">
                            <bean class="edu.stanford.irt.laneweb.ldap.GSSAPIAuthenticationStrategy"
                            />
                        </property>
                        <property name="baseEnvironmentProperties">
                            <map>
                                <entry key="com.sun.jndi.ldap.connect.timeout" value="5000"/>
                            </map>
                        </property>
                    </bean>
                </constructor-arg>
            </bean>
        </property>
    </bean>
    
    <bean class="edu.stanford.irt.spell.GoogleToolbarSpellChecker"/>
    
    <bean name="org.apache.cocoon.core.xml.SAXParser"
        class="org.apache.cocoon.core.xml.impl.JaxpSAXParser">
        <property name="validate" value="false"/>
    </bean>
    
    <bean id="org.apache.cocoon.caching.Cache"
        class="edu.stanford.irt.laneweb.cocoon.EHCache"
        destroy-method="destroy">
        <constructor-arg>
            <bean class="org.springframework.cache.ehcache.EhCacheManagerFactoryBean"/>
        </constructor-arg>
    </bean>
    
    <bean id="edu.stanford.irt.cocoon.Model"
        class="java.util.HashMap"
        scope="request">
    </bean>
    
    <bean name="javax.xml.transform.sax.SAXTransformerFactory/saxon"
        class="edu.stanford.irt.laneweb.util.SAXTransformerFactoryBean">
        <property name="transformerFactoryClass" value="net.sf.saxon.TransformerFactoryImpl"/>
    </bean>
    
    <bean name="javax.xml.transform.sax.SAXTransformerFactory/joost"
        class="edu.stanford.irt.laneweb.util.SAXTransformerFactoryBean">
        <property name="transformerFactoryClass" value="net.sf.joost.trax.TransformerFactoryImpl"/>
    </bean>
    
    <bean name="javax.xml.transform.sax.SAXTransformerFactory/xalan"
        class="edu.stanford.irt.laneweb.util.SAXTransformerFactoryBean">
        <property name="transformerFactoryClass" value="com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl"/>
    </bean>
    
    <bean name="edu.stanford.irt.cocoon.xml.TransformerHandlerFactory/saxon"
        class="edu.stanford.irt.cocoon.xml.TransformerHandlerFactory">
        <constructor-arg ref="javax.xml.transform.sax.SAXTransformerFactory/saxon"/>
        <constructor-arg ref="javax.xml.transform.URIResolver"/>
        <constructor-arg ref="javax.xml.transform.ErrorListener"/>
    </bean>
    
    <bean name="edu.stanford.irt.cocoon.xml.TransformerHandlerFactory/joost"
        class="edu.stanford.irt.cocoon.xml.TransformerHandlerFactory">
        <constructor-arg ref="javax.xml.transform.sax.SAXTransformerFactory/joost"/>
        <constructor-arg ref="javax.xml.transform.URIResolver"/>
        <constructor-arg ref="javax.xml.transform.ErrorListener"/>
    </bean>
    
    <bean name="edu.stanford.irt.cocoon.xml.TransformerHandlerFactory/xalan"
        class="edu.stanford.irt.cocoon.xml.TransformerHandlerFactory">
        <constructor-arg ref="javax.xml.transform.sax.SAXTransformerFactory/xalan"/>
        <constructor-arg ref="javax.xml.transform.URIResolver"/>
        <constructor-arg ref="javax.xml.transform.ErrorListener"/>
    </bean>
    
    <bean id="javax.xml.transform.URIResolver"
        class="edu.stanford.irt.cocoon.xml.URIResolverImpl">
        <constructor-arg ref="org.apache.excalibur.source.SourceResolver"/>
    </bean>
    
    <bean name="javax.xml.transform.ErrorListener"
        class="edu.stanford.irt.laneweb.cocoon.TransformerErrorListener"/>
    
    <bean id="org.springframework.oxm.Marshaller"
        class="org.springframework.oxm.xstream.XStreamMarshaller">
        <property name="aliases">
            <map>
                <!--<entry key="eresource" value="edu.stanford.irt.eresources.impl.EresourceImpl"/>
                <entry key="seresource" value="edu.stanford.irt.eresources.impl.SearchEresourceImpl"/>
                <entry key="link" value="edu.stanford.irt.eresources.impl.LinkImpl"/>
                <entry key="paging" value="edu.stanford.irt.laneweb.eresources.PagingData"/>
                <entry key="region" value="edu.stanford.irt.laneweb.bassett.RegionCount"/>
                <entry key="bassett" value="edu.stanford.irt.laneweb.bassett.BassettImage"/>
                <entry key="mresource" value="edu.stanford.irt.search.impl.DefaultContentResult"/>
                <entry key="result" value="edu.stanford.irt.search.impl.DefaultResult"/>-->
                <entry key="bookmark" value="edu.stanford.irt.laneweb.bookmarks.Bookmark"/>
            </map>
        </property>
    </bean>
    
    <bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <!-- change from default because of maven filter properties seen as properties in dev environment -->
        <property name="placeholderPrefix" value="%{"></property>
    </bean>
    
    <bean id="edu.stanford.irt.laneweb.servlet.SHCCodec"
        class="edu.stanford.irt.laneweb.servlet.SHCCodec">
        <constructor-arg value="%{laneweb.shccodec.key}"/>
        <constructor-arg value="%{laneweb.shccodec.vector}"/>
    </bean>
    
    <bean class="edu.stanford.irt.laneweb.servlet.SunetIdCookieCodec">
        <constructor-arg value="%{laneweb.sunetidcookiecodec.key}"/>
    </bean>
    
    <bean name="edu.stanford.irt.laneweb.servlet.SunetIdSource"
        class="edu.stanford.irt.laneweb.servlet.SunetIdSource">
        <property name="sunetIdCookieCodec" ref="edu.stanford.irt.laneweb.servlet.SunetIdCookieCodec"/>
    </bean>
    
    <bean id="org.apache.avalon.framework.service.ServiceManager"
        class="org.apache.cocoon.core.container.spring.avalon.AvalonServiceManager"/>
    
    <bean id="org.apache.cocoon.core.container.spring.logger.Log"
        class="org.apache.cocoon.core.container.spring.logger.LoggerFactoryBean"/>    
    
    <bean id="org.apache.cocoon.configuration.Settings" class="edu.stanford.irt.laneweb.cocoon.Settings">
        <property name="tempDir" value="#{contextAttributes['javax.servlet.context.tempdir']}"/>
    </bean>
    
    <bean name="org.apache.excalibur.xml.xpath.XPathProcessor"
        class="edu.stanford.irt.laneweb.cocoon.XPathProcessorImpl"/>
    
    <bean id="org.apache.cocoon.el.objectmodel.ObjectModel"
        class="edu.stanford.irt.laneweb.cocoon.LanewebObjectModel">
    </bean>
    
    <bean id="javax.servlet.ServletContext"
        class="org.apache.cocoon.spring.configurator.impl.ServletContextFactoryBean"/>
    
    <bean id="org.apache.excalibur.xmlizer.XMLizer"
        class="edu.stanford.irt.laneweb.cocoon.LanewebXMLizer"/>
    
</beans>
