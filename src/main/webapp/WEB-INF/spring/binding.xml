<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">
    
    <bean name="edu.stanford.irt.laneweb.servlet.binding.DataBinder"
        class="edu.stanford.irt.laneweb.servlet.binding.CompositeDataBinder">
        <property name="dataBinders">
            <list>
                <ref bean="edu.stanford.irt.laneweb.servlet.binding.DataBinder/sunetid"/>
                <ref bean="edu.stanford.irt.laneweb.servlet.binding.DataBinder/debug"/>
                <ref bean="edu.stanford.irt.laneweb.servlet.binding.DataBinder/ldap"/>
                <ref bean="edu.stanford.irt.laneweb.servlet.binding.DataBinder/remote-proxy-ip"/>
                <ref bean="edu.stanford.irt.laneweb.servlet.binding.DataBinder/template"/>
                <ref bean="edu.stanford.irt.laneweb.servlet.binding.DataBinder/emrid"/>
                <ref bean="edu.stanford.irt.laneweb.servlet.binding.DataBinder/request-parameter"/>
                <ref bean="edu.stanford.irt.laneweb.servlet.binding.DataBinder/request-method"/>
                <ref bean="edu.stanford.irt.laneweb.servlet.binding.DataBinder/user-cookie"/>
                <ref bean="edu.stanford.irt.laneweb.servlet.binding.DataBinder/base-path"/>
                <ref bean="edu.stanford.irt.laneweb.servlet.binding.DataBinder/parent-path"/>
                <ref bean="edu.stanford.irt.laneweb.servlet.binding.DataBinder/servlet-context"/>
            </list>
        </property>
    </bean>


    <bean name="edu.stanford.irt.laneweb.servlet.binding.DataBinder/sunetid"
        class="edu.stanford.irt.laneweb.servlet.binding.SunetIdAndTicketDataBinder">
        <property name="ezproxyKey" value="#{contextAttributes['laneweb.context.ezproxy-key']}"/>
    </bean>
    <bean name="edu.stanford.irt.laneweb.servlet.binding.DataBinder/debug"
        class="edu.stanford.irt.laneweb.servlet.binding.BooleanSessionParameterDataBinder">
        <property name="parameterName" value="debug"/>
        <property name="modelKey" value="debug"/>
    </bean>
    <bean name="edu.stanford.irt.laneweb.servlet.binding.DataBinder/ldap"
        class="edu.stanford.irt.laneweb.servlet.binding.LDAPDataBinder">
        <property name="LDAPDataAccess" ref="edu.stanford.irt.laneweb.ldap.LDAPDataAccess"/>
    </bean>
    <bean name="edu.stanford.irt.laneweb.servlet.binding.DataBinder/remote-proxy-ip"
        class="edu.stanford.irt.laneweb.servlet.binding.RemoteProxyIPDataBinder">
        <property name="proxyLinks" ref="edu.stanford.irt.laneweb.servlet.binding.ProxyLinks"/>
    </bean>
    <bean name="edu.stanford.irt.laneweb.servlet.binding.DataBinder/template"
        class="edu.stanford.irt.laneweb.servlet.binding.TemplateDataBinder">
        <property name="templateChooser" ref="edu.stanford.irt.laneweb.servlet.binding.TemplateChooser"/>
    </bean>
    <bean name="edu.stanford.irt.laneweb.servlet.binding.DataBinder/emrid"
        class="edu.stanford.irt.laneweb.servlet.binding.StringSessionParameterDataBinder">
        <property name="parameterName" value="emrid"/>
        <property name="modelKey" value="emrid"/>
    </bean>
    <bean name="edu.stanford.irt.laneweb.servlet.binding.DataBinder/request-parameter"
        class="edu.stanford.irt.laneweb.servlet.binding.RequestParameterDataBinder"/>
    <bean name="edu.stanford.irt.laneweb.servlet.binding.DataBinder/request-method"
        class="edu.stanford.irt.laneweb.servlet.binding.RequestMethodDataBinder"/>
    <bean name="edu.stanford.irt.laneweb.servlet.binding.DataBinder/user-cookie"
        class="edu.stanford.irt.laneweb.servlet.binding.UserCookieDataBinder"/>
    <bean name="edu.stanford.irt.laneweb.servlet.binding.DataBinder/base-path"
        class="edu.stanford.irt.laneweb.servlet.binding.RequestAttributeDataBinder"/>
    <bean name="edu.stanford.irt.laneweb.servlet.binding.DataBinder/parent-path"
        class="edu.stanford.irt.laneweb.servlet.binding.ParentPathDataBinder"/>
    <bean name="edu.stanford.irt.laneweb.servlet.binding.DataBinder/servlet-context"
        class="edu.stanford.irt.laneweb.servlet.binding.ServletContextDataBinder">
        <property name="servletContext" ref="servletContext"/>
    </bean>

    <bean id="edu.stanford.irt.laneweb.servlet.binding.ProxyLinks"
        class="edu.stanford.irt.laneweb.servlet.binding.ProxyLinks">
        <property name="proxyRegex">
            <list>
                <!-- VPN 171.65.16.0 - 171.65.31.255 -->
                <value>^171\.66\.(?:1[6-9]|2[0-9]|3[0-1])\.\S+</value>
                <!-- hospital 171.65.44.0 - 171.65.44.255 -->
                <value>^171\.65\.44\.\S+</value>
                <!-- hospital 171.65.125.0 - 171.65.125.255 -->
                <value>^171\.65\.125\.\S+</value>
                <!-- hospital 171.65.128.0 - 171.65.199.255 -->
                <value>^171\.65\.1(?:2[8-9]|[3-9][0-9])\.\S+</value>
                <!-- hospital 171.65.200.0 - 171.65.255.255 -->
                <value>^171\.65\.2[0-5][0-9]\.\S+</value>
            </list>
        </property>
        <property name="noProxyRegex">
            <list>
                <value>^171\.6[4-7]\.\S+</value>
                <!-- campus wireless 10.32.0.0 through 10.33.255.255 -->
                <value>^10\.3[2-3]\.\S+</value>
                <!-- library wireless 10.39.32.1 through 10.39.47.255 -->
                <value>^10\.39\.(?:3[2-9]|4[0-7])\.\S+</value>
            </list>
        </property>
    </bean>

    <bean id="edu.stanford.irt.laneweb.servlet.binding.TemplateChooser"
        class="edu.stanford.irt.laneweb.servlet.binding.TemplateChooser">
        <constructor-arg value="template"/>
        <constructor-arg>
            <value>template, bassettLargetView, mobile, none</value>
        </constructor-arg>
        <constructor-arg>
            <map>
                <entry key="^(?:/\w+|)/biomed-resources/bassett/raw/bassettLargerView.html"
                    value="bassettLargerView"/>
                <entry key="^(?:/\w+|)/m/(?:.*)" value="mobile"/>
            </map>
        </constructor-arg>
    </bean>

</beans>
