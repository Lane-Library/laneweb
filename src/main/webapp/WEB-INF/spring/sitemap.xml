<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

    <bean name="org.apache.cocoon.Processor" abstract="true"
        class="edu.stanford.irt.cocoon.sitemap.SitemapImpl">
        <constructor-arg index="1" ref="sitemap"/>
        <constructor-arg index="2" ref="edu.stanford.irt.cocoon.sitemap.ComponentFactory"/>
    </bean>
    
    <bean id="parentNodeBuilder" abstract="true">
        <property name="componentFactory" ref="edu.stanford.irt.cocoon.sitemap.ComponentFactory"/>
        <property name="expressionParser" ref="edu.stanford.irt.cocoon.sitemap.expression.ExpressionParser"/>
    </bean>
    
    <bean name="sitemap"
        class="org.apache.cocoon.components.treeprocessor.sitemap.SitemapNodeBuilder"
        parent="parentNodeBuilder"/>
    
    <bean name="pipelines"
        class="org.apache.cocoon.components.treeprocessor.sitemap.PipelinesNodeBuilder"
        parent="parentNodeBuilder"/>
    
    <bean name="pipeline"
        class="org.apache.cocoon.components.treeprocessor.sitemap.PipelineNodeBuilder"
        parent="parentNodeBuilder"/>
    
    <bean name="match"
        class="org.apache.cocoon.components.treeprocessor.sitemap.MatchNodeBuilder"
        parent="parentNodeBuilder"/>
    
    <bean name="select"
        class="org.apache.cocoon.components.treeprocessor.sitemap.SelectNodeBuilder"
        parent="parentNodeBuilder"/>
    
    <bean name="generate"
        class="org.apache.cocoon.components.treeprocessor.sitemap.GenerateNodeBuilder"
        parent="parentNodeBuilder"/>
    
    <bean name="aggregate"
        class="org.apache.cocoon.components.treeprocessor.sitemap.AggregateNodeBuilder"
        parent="parentNodeBuilder"/>
    
    <bean name="part"
        class="org.apache.cocoon.components.treeprocessor.sitemap.PartNodeBuilder"
        parent="parentNodeBuilder"/>
    
    <bean name="transform"
        class="org.apache.cocoon.components.treeprocessor.sitemap.TransformNodeBuilder"
        parent="parentNodeBuilder"/>
    
    <bean name="serialize"
        class="org.apache.cocoon.components.treeprocessor.sitemap.SerializeNodeBuilder"
        parent="parentNodeBuilder"/>
    
    <bean name="org.apache.cocoon.matching.Matcher/wildcard"
        class="edu.stanford.irt.cocoon.sitemap.match.WildcardMatcher">
        <constructor-arg value="sitemap-uri"/>
    </bean>
    
    <bean name="org.apache.cocoon.matching.Matcher/url-decoding-wildcard"
        class="edu.stanford.irt.cocoon.sitemap.match.URLDecodingMatcher">
        <constructor-arg value="sitemap-uri"/>
    </bean>
    
    <bean name="org.apache.cocoon.matching.Matcher/regexp"
        class="edu.stanford.irt.cocoon.sitemap.match.RegexpMatcher">
        <constructor-arg value="sitemap-uri"/>
    </bean>
    
    <bean name="org.apache.cocoon.matching.Matcher/regex-parameter"
        class="edu.stanford.irt.cocoon.sitemap.match.ParameterRegexpMatcher"/>
    
    <bean name="org.apache.cocoon.selection.Selector/ipgroup"
        class="edu.stanford.irt.laneweb.ipgroup.IPGroupSelector"/>
    
    <bean name="org.apache.cocoon.selection.Selector/logged-in"
        class="edu.stanford.irt.cocoon.sitemap.select.ModelAttributeSelector">
        <property name="attributeName" value="sunetid"/>
    </bean>
    
    <bean name="org.apache.cocoon.selection.Selector/resource-exists"
        class="edu.stanford.irt.cocoon.sitemap.select.ResourceExistsSelector">
        <constructor-arg ref="org.apache.excalibur.source.SourceResolver"/>
    </bean>
    
    <bean name="org.apache.cocoon.Processor/sitemap" parent="org.apache.cocoon.Processor">
        <constructor-arg index="0" value="/sitemap.xmap"/>
    </bean>

    <bean name="org.apache.cocoon.Processor/content" parent="org.apache.cocoon.Processor">
        <constructor-arg index="0" value="/content.xmap"/>
    </bean>

    <bean name="org.apache.cocoon.Processor/eresources" parent="org.apache.cocoon.Processor">
        <constructor-arg index="0" value="/eresources.xmap"/>
    </bean>

    <bean name="org.apache.cocoon.Processor/applications" parent="org.apache.cocoon.Processor">
        <constructor-arg index="0" value="/applications.xmap"/>
    </bean>

    <bean name="org.apache.cocoon.Processor/rss" parent="org.apache.cocoon.Processor">
        <constructor-arg index="0" value="/rss.xmap"/>
    </bean>
	
	<bean name="org.apache.cocoon.Processor/classes" parent="org.apache.cocoon.Processor">
        <constructor-arg index="0" value="/classes.xmap"/>
    </bean>

    <bean name="org.apache.cocoon.Processor/mobile" parent="org.apache.cocoon.Processor">
        <constructor-arg index="0" value="/mobile.xmap"/>
    </bean>
    
    <bean name="org.apache.cocoon.Processor/bookmarks" parent="org.apache.cocoon.Processor">
        <constructor-arg index="0" value="classpath:/edu/stanford/irt/laneweb/bookmarks/bookmarks.xmap"/>
    </bean>
    
    <bean name="edu.stanford.irt.cocoon.sitemap.expression.ExpressionParser"
        class="edu.stanford.irt.cocoon.sitemap.expression.ExpressionParser"/>
    
    <bean id="edu.stanford.irt.cocoon.sitemap.node.PipelinesNode"
        class="edu.stanford.irt.cocoon.sitemap.node.PipelinesNode"
        scope="prototype"/>
    
    <bean id="edu.stanford.irt.cocoon.sitemap.node.PipelineNode"
        class="edu.stanford.irt.cocoon.sitemap.node.PipelineNode"
        scope="prototype"/>
    
    <bean id="edu.stanford.irt.cocoon.sitemap.node.MatchNode"
        class="edu.stanford.irt.cocoon.sitemap.node.MatchNode"
        scope="prototype"/>
    
    <bean id="edu.stanford.irt.cocoon.sitemap.node.SelectNode"
        class="edu.stanford.irt.cocoon.sitemap.node.SelectNode"
        scope="prototype">
        <property name="componentFactory" ref="edu.stanford.irt.cocoon.sitemap.ComponentFactory"/>
    </bean>
    
    <bean id="edu.stanford.irt.cocoon.sitemap.node.AbstractPipelineComponentNode"
        scope="prototype"
        abstract="true">
        <property name="componentFactory" ref="edu.stanford.irt.cocoon.sitemap.ComponentFactory"/>
        <property name="sourceResolver" ref="org.apache.excalibur.source.SourceResolver"/>
    </bean>
        
    <bean id="edu.stanford.irt.cocoon.sitemap.node.GenerateNode"
        class="edu.stanford.irt.cocoon.sitemap.node.GenerateNode"
        parent="edu.stanford.irt.cocoon.sitemap.node.AbstractPipelineComponentNode"/>
    
    <bean id="edu.stanford.irt.cocoon.sitemap.node.AggregateNode"
        class="edu.stanford.irt.cocoon.sitemap.node.AggregateNode"
        parent="edu.stanford.irt.cocoon.sitemap.node.AbstractPipelineComponentNode"/>
    
    <bean id="edu.stanford.irt.cocoon.sitemap.node.PartNode"
        class="edu.stanford.irt.cocoon.sitemap.node.PartNode"
        parent="edu.stanford.irt.cocoon.sitemap.node.AbstractPipelineComponentNode"/>
    
    <bean id="edu.stanford.irt.cocoon.sitemap.node.TransformNode"
        class="edu.stanford.irt.cocoon.sitemap.node.TransformNode"
        parent="edu.stanford.irt.cocoon.sitemap.node.AbstractPipelineComponentNode"/>
    
    <bean id="edu.stanford.irt.cocoon.sitemap.node.SerializeNode"
        class="edu.stanford.irt.cocoon.sitemap.node.SerializeNode"
        parent="edu.stanford.irt.cocoon.sitemap.node.AbstractPipelineComponentNode"/>

</beans>