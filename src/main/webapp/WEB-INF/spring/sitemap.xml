<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

    <bean name="org.apache.cocoon.Processor" abstract="true"
        class="edu.stanford.irt.cocoon.sitemap.SitemapImpl">
        <constructor-arg index="1" ref="org.apache.cocoon.core.xml.SAXParser/xml"/>
        <constructor-arg index="2" ref="org.apache.cocoon.components.treeprocessor.TreeBuilder"/>
        <constructor-arg index="3" ref="org.apache.avalon.framework.service.ServiceManager"/>
    </bean>
    
    <bean name="sitemap"
        class="org.apache.cocoon.components.treeprocessor.sitemap.SitemapNodeBuilder"/>
    
    <bean name="pipelines"
        class="org.apache.cocoon.components.treeprocessor.sitemap.PipelinesNodeBuilder"/>
    
    <bean name="pipeline"
        class="org.apache.cocoon.components.treeprocessor.sitemap.PipelineNodeBuilder"
        scope="prototype"/>
    
    <bean name="match"
        class="org.apache.cocoon.components.treeprocessor.sitemap.MatchNodeBuilder"/>
    
    <bean name="select"
        class="org.apache.cocoon.components.treeprocessor.sitemap.SelectNodeBuilder"
        scope="prototype"/>
    
    <bean name="generate"
        class="org.apache.cocoon.components.treeprocessor.sitemap.GenerateNodeBuilder"
        scope="prototype"/>
    
    <bean name="aggregate"
        class="org.apache.cocoon.components.treeprocessor.sitemap.AggregateNodeBuilder"
        scope="prototype"/>
    
    <bean name="transform"
        class="org.apache.cocoon.components.treeprocessor.sitemap.TransformNodeBuilder"
        scope="prototype"/>
    
    <bean name="serialize"
        class="org.apache.cocoon.components.treeprocessor.sitemap.SerializeNodeBuilder"
        scope="prototype"/>
    
    <bean name="org.apache.cocoon.matching.Matcher/wildcard"
        class="edu.stanford.irt.cocoon.sitemap.match.WildcardMatcher">
        <constructor-arg value="sitemap-uri"/>
    </bean>
    
    <bean name="org.apache.cocoon.matching.Matcher/url-decoding-wildcard"
        class="edu.stanford.irt.cocoon.sitemap.match.URLDecodingMatcher">
        <constructor-arg value="sitemap-uri"/>
    </bean>
    
    <bean name="org.apache.cocoon.matching.Matcher/regexp"
        class="edu.stanford.irt.cocoon.sitemap.match.RegexpMatcher">
        <constructor-arg value="sitemap-uri"/>
    </bean>
    
    <bean name="org.apache.cocoon.matching.Matcher/regex-parameter"
        class="edu.stanford.irt.cocoon.sitemap.match.ParameterRegexpMatcher"/>
    
    <bean name="org.apache.cocoon.selection.Selector/ipgroup"
        class="edu.stanford.irt.laneweb.ipgroup.IPGroupSelector"/>
    
    <bean name="org.apache.cocoon.selection.Selector/logged-in"
        class="edu.stanford.irt.cocoon.sitemap.select.ModelAttributeSelector">
        <property name="attributeName" value="sunetid"/>
    </bean>
    
    <bean name="org.apache.cocoon.selection.Selector/resource-exists"
        class="edu.stanford.irt.cocoon.sitemap.select.ResourceExistsSelector">
        <constructor-arg ref="org.apache.excalibur.source.SourceResolver"/>
    </bean>
    
    <bean name="org.apache.cocoon.Processor/sitemap" parent="org.apache.cocoon.Processor">
        <constructor-arg index="0" value="/sitemap.xmap"/>
    </bean>

    <bean name="org.apache.cocoon.Processor/content" parent="org.apache.cocoon.Processor">
        <constructor-arg index="0" value="/content.xmap"/>
    </bean>

    <bean name="org.apache.cocoon.Processor/eresources" parent="org.apache.cocoon.Processor">
        <constructor-arg index="0" value="/eresources.xmap"/>
    </bean>

    <bean name="org.apache.cocoon.Processor/applications" parent="org.apache.cocoon.Processor">
        <constructor-arg index="0" value="/applications.xmap"/>
    </bean>

    <bean name="org.apache.cocoon.Processor/rss" parent="org.apache.cocoon.Processor">
        <constructor-arg index="0" value="/rss.xmap"/>
    </bean>
	
	<bean name="org.apache.cocoon.Processor/classes" parent="org.apache.cocoon.Processor">
        <constructor-arg index="0" value="/classes.xmap"/>
    </bean>

    <bean name="org.apache.cocoon.Processor/mobile" parent="org.apache.cocoon.Processor">
        <constructor-arg index="0" value="/mobile.xmap"/>
    </bean>
    
    <bean name="org.apache.cocoon.Processor/bookmarks" parent="org.apache.cocoon.Processor">
        <constructor-arg index="0" value="classpath:/edu/stanford/irt/laneweb/bookmarks/bookmarks.xmap"/>
    </bean>
    
    <bean name="edu.stanford.irt.cocoon.sitemap.expression.ExpressionParser"
        class="edu.stanford.irt.cocoon.sitemap.expression.ExpressionParser"/>
    
    <bean id="org.apache.cocoon.matching.MatcherSelector"
        class="org.apache.cocoon.core.container.spring.avalon.AvalonServiceSelector">
        <constructor-arg value="org.apache.cocoon.matching.Matcher"/>
    </bean>
    
    <bean id="org.apache.cocoon.acting.ActionSelector"
        class="org.apache.cocoon.core.container.spring.avalon.AvalonServiceSelector">
        <constructor-arg value="org.apache.cocoon.acting.Action"/>
    </bean>
    
    <bean id="org.apache.cocoon.selection.SelectorSelector"
        class="org.apache.cocoon.core.container.spring.avalon.AvalonServiceSelector">
        <constructor-arg value="org.apache.cocoon.selection.Selector"/>
    </bean>
    
    <bean name="org.apache.cocoon.components.pipeline.impl.PipelineComponentInfo"
        class="org.apache.cocoon.core.container.spring.pipeline.PipelineComponentInfoFactoryBean"
        init-method="init"/>
    
    <bean name="org.apache.cocoon.components.treeprocessor.TreeBuilder"
        class="edu.stanford.irt.laneweb.cocoon.LanewebSitemapLanguage" scope="prototype">
        <constructor-arg ref="org.apache.avalon.framework.service.ServiceManager"/>
        <constructor-arg ref="org.apache.cocoon.components.pipeline.impl.PipelineComponentInfo"/>
    </bean>
    
    <bean id="org.apache.cocoon.components.treeprocessor.variables.VariableResolver"
        class="edu.stanford.irt.cocoon.sitemap.expression.VariableImpl"
        scope="prototype">
        <constructor-arg ref="edu.stanford.irt.cocoon.sitemap.expression.ExpressionParser"/>
    </bean>

</beans>