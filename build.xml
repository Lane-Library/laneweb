<?xml version="1.0" encoding="UTF-8"?>
<project default="all" name="laneweb" basedir=".">
    <property name="defaulttargetdir" value="target"/>
    <property name="libdir" value="target/lib"/>
    <property name="classesdir" value="target/classes"/>
    <property name="testclassesdir" value="target/test-classes"/>
    <property name="testreportdir" value="target/test-reports"/>
    <property name="endorseddir" value="target/endorsed"/>
    <property name="distdir" value="dist"/>
    <property name="javadocdir" value="dist/docs/api"/>
    <property name="final.name" value="laneweb-2.1"/>
    <property name="builddir" value="build"/>
    <property name="docsdir" value="docs"/>
    <available file="../laneweb.properties" property="laneweb.production"/>
    <target name="init" description="o Initializes some properties">
        <mkdir dir="${libdir}"/>
        <mkdir dir="${endorseddir}"/>
        <condition property="noget">
            <equals arg2="only" arg1="${build.sysclasspath}"/>
        </condition>
    </target>
    <target name="compile" description="o Compile the code" depends="get-deps">
        <mkdir dir="${classesdir}"/>
        <javac destdir="${classesdir}" deprecation="true" debug="true" optimize="false"
            excludes="**/package.html">
            <src>
                <pathelement location="src/java"/>
            </src>
            <classpath>
                <fileset dir="${libdir}">
                    <include name="*.jar"/>
                </fileset>
            </classpath>
        </javac>
    </target>
    <target name="production" if="laneweb.production">
        <copy todir="target/laneweb/WEB-INF">
            <fileset dir="src/conf">
                <include name="*.xconf"/>
            </fileset>
            <filterset filtersfile="../laneweb.properties" begintoken="***" endtoken="***"/>
        </copy>
    </target>
    <target name="stage" unless="laneweb.production">
        <copy todir="target/laneweb/WEB-INF">
            <fileset dir="src/conf">
                <include name="*.xconf"/>
            </fileset>
            <filterset filtersfile="project.properties" begintoken="***" endtoken="***"/>
        </copy>
    </target>
    <target name="webapp" depends="compile,prepare-webapp,production,stage"/>
    <target name="prepare-webapp">
        <copy todir="target/laneweb">
            <fileset dir="src/webapp"/>
        </copy>
        <copy todir="target/laneweb/WEB-INF/lib">
            <fileset dir="target/lib" excludes="servlet-api*"/>
        </copy>
        <copy todir="target/laneweb/WEB-INF/classes">
            <fileset dir="target/classes"/>
        </copy>
    </target>
    <target name="war" depends="webapp">
        <war destfile="target/laneweb.war" webxml="src/webapp/WEB-INF/web.xml"
            basedir="target/laneweb"/>
    </target>
    <target name="dist" depends="war">
        <copy todir="${distdir}">
            <fileset dir="${defaulttargetdir}" includes="laneweb/**,laneweb.war"/>
        </copy>
    </target>
    <target name="clean" description="o Clean up the generated directories">
        <!--delete dir="${defaulttargetdir}"/-->
        <delete dir="${distdir}"/>
        <delete dir="${docsdir}"/>
        <delete dir="${defaulttargetdir}/laneweb"/>
        <delete file="${defaulttargetdir}/laneweb.war"/>
        <delete dir="${defaulttargetdir}/classes"/>
    </target>
    <target name="docs" depends="javadoc">
        <copy todir="${docsdir}">
            <fileset dir="${javadocdir}"/>
        </copy>
    </target>
    <target name="all" depends="clean,dist,docs"/>
    <target name="javadoc" description="o Generate javadoc" depends="compile">
        <mkdir dir="${javadocdir}"/>
        <tstamp>
            <format pattern="2002-yyyy" property="year"/>
        </tstamp>
        <property name="copyright"
            value="Copyright &amp;copy;  Lane Medical Library. All Rights Reserved."/>
        <property name="title" value="Lane Library Website 2.1 API"/>
        <javadoc use="true" private="true" destdir="${javadocdir}" author="true" version="true"
            sourcepath="src/java" packagenames="edu.stanford.*">
            <classpath>
                <fileset dir="${libdir}">
                    <include name="*.jar"/>
                </fileset>
                <pathelement location="target/${final.name}.jar"/>
            </classpath>
        </javadoc>
    </target>
    <target name="get-deps" unless="noget" depends="init">
        <get dest="${libdir}/avalon-framework-api-4.1.5.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.ibiblio.org/maven/avalon-framework/jars/avalon-framework-api-4.1.5.jar"/>
        <get dest="${libdir}/avalon-framework-impl-4.1.5.jar" usetimestamp="true"
            ignoreerrors="true"
            src="http://www.ibiblio.org/maven/avalon-framework/jars/avalon-framework-impl-4.1.5.jar"/>
        <get dest="${libdir}/cocoon-2.1.7.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.ibiblio.org/maven/cocoon/jars/cocoon-2.1.7.jar"/>
        <get dest="${libdir}/cocoon-databases-2.1.7.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.ibiblio.org/maven/cocoon/jars/cocoon-databases-2.1.7.jar"/>
        <get dest="${libdir}/cocoon-html-2.1.7.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.ibiblio.org/maven/cocoon/jars/cocoon-html-2.1.7.jar"/>
        <get dest="${libdir}/cocoon-paranoid-2.1.7.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.ibiblio.org/maven/cocoon/jars/cocoon-paranoid-2.1.7.jar"/>
        <get dest="${libdir}/cocoon-proxy-2.1.7.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.ibiblio.org/maven/cocoon/jars/cocoon-proxy-2.1.7.jar"/>
        <get dest="${libdir}/commons-collections-3.1.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.ibiblio.org/maven/commons-collections/jars/commons-collections-3.1.jar"/>
        <get dest="${libdir}/commons-httpclient-3.0-rc4-log4j.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.stanford.edu/~ceyates/maven/commons-httpclient/jars/commons-httpclient-3.0-rc4-log4j.jar"/>
        <get dest="${libdir}/commons-codec-1.3.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.ibiblio.org/maven/commons-codec/jars/commons-codec-1.3.jar"/>
        <get dest="${libdir}/commons-jxpath-1.2.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.ibiblio.org/maven/commons-jxpath/jars/commons-jxpath-1.2.jar"/>
        <get dest="${libdir}/commons-lang-2.0-20041007T2305.jar" usetimestamp="true"
            ignoreerrors="true"
            src="http://www.stanford.edu/~ceyates/maven/commons-lang/jars/commons-lang-2.0-20041007T2305.jar"/>
        <get dest="${libdir}/concurrent-1.3.4.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.ibiblio.org/maven/concurrent/jars/concurrent-1.3.4.jar"/>
        <get dest="${libdir}/excalibur-component-1.2.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.ibiblio.org/maven/excalibur-component/jars/excalibur-component-1.2.jar"/>
        <get dest="${libdir}/excalibur-datasource-1.1.1.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.ibiblio.org/maven/excalibur-datasource/jars/excalibur-datasource-1.1.1.jar"/>
        <get dest="${libdir}/excalibur-i18n-1.1.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.ibiblio.org/maven/excalibur-i18n/jars/excalibur-i18n-1.1.jar"/>
        <get dest="${libdir}/excalibur-instrument-1.0.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.ibiblio.org/maven/excalibur-instrument/jars/excalibur-instrument-1.0.jar"/>
        <get dest="${libdir}/excalibur-instrument-manager-1.0.jar" usetimestamp="true"
            ignoreerrors="true"
            src="http://www.ibiblio.org/maven/excalibur-instrument-manager/jars/excalibur-instrument-manager-1.0.jar"/>
        <get dest="${libdir}/excalibur-instrument-manager-interfaces-1.0.jar" usetimestamp="true"
            ignoreerrors="true"
            src="http://www.ibiblio.org/maven/excalibur-instrument-manager-interfaces/jars/excalibur-instrument-manager-interfaces-1.0.jar"/>
        <get dest="${libdir}/excalibur-logger-1.1.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.ibiblio.org/maven/excalibur-logger/jars/excalibur-logger-1.1.jar"/>
        <get dest="${libdir}/excalibur-pool-1.2.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.ibiblio.org/maven/excalibur-pool/jars/excalibur-pool-1.2.jar"/>
        <get dest="${libdir}/excalibur-sourceresolve-1.1.jar" usetimestamp="true"
            ignoreerrors="true"
            src="http://www.ibiblio.org/maven/excalibur-sourceresolve/jars/excalibur-sourceresolve-1.1.jar"/>
        <get dest="${libdir}/excalibur-store-1.0.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.ibiblio.org/maven/excalibur-store/jars/excalibur-store-1.0.jar"/>
        <get dest="${libdir}/excalibur-xmlutil-1.0.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.ibiblio.org/maven/excalibur-xmlutil/jars/excalibur-xmlutil-1.0.jar"/>
        <get dest="${libdir}/joost-20040330.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.stanford.edu/~ceyates/maven/joost/jars/joost-20040330.jar"/>
        <get dest="${libdir}/jtidy-04aug2000r7-dev.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.stanford.edu/~ceyates/maven/jtidy/jars/jtidy-04aug2000r7-dev.jar"/>
        <get dest="${libdir}/logkit-1.2.2-nomanifest.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.stanford.edu/~ceyates/maven/logkit/jars/logkit-1.2.2-nomanifest.jar"/>
        <get dest="${libdir}/marc4j-b7.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.stanford.edu/~ceyates/maven/marc4j/jars/marc4j-b7.jar"/>
        <get dest="${endorseddir}/medlane-ansel-0.1.1.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.stanford.edu/~ceyates/maven/medlane-ansel/jars/medlane-ansel-0.1.1.jar"/>
        <get dest="${libdir}/oracle-jdbc-1.4.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.stanford.edu/~ceyates/maven/oracle-jdbc/jars/oracle-jdbc-1.4.jar"/>
        <get dest="${libdir}/servlet-api-5.0.18.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.ibiblio.org/maven/tomcat/jars/servlet-api-5.0.18.jar"/>
        <get dest="${libdir}/xalan-2.6.1-dev-20041008T0304.jar" usetimestamp="true"
            ignoreerrors="true"
            src="http://www.stanford.edu/~ceyates/maven/xalan/jars/xalan-2.6.1-dev-20041008T0304.jar"/>
        <get dest="${libdir}/xercesImpl-2.6.2.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.ibiblio.org/maven/xerces/jars/xercesImpl-2.6.2.jar"/>
        <get dest="${libdir}/xml-apis-1.0.b2.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.ibiblio.org/maven/xml-apis/jars/xml-apis-1.0.b2.jar"/>
        <get dest="${libdir}/ehcache-1.1.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.ibiblio.org/maven/ehcache/jars/ehcache-1.1.jar"/>
        <get dest="${libdir}/regexp-1.3.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.ibiblio.org/maven/regexp/jars/regexp-1.3.jar"/>
        <get dest="${libdir}/bcel-20040329.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.stanford.edu/~ceyates/maven/bcel/jars/bcel-20040329.jar"/>
        <get dest="${libdir}/log4j-1.2.9.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.stanford.edu/~ceyates/maven/log4j/jars/log4j-1.2.9.jar"/>
        <get dest="${libdir}/javamail-1.3.1.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.stanford.edu/~ceyates/maven/javamail/jars/javamail-1.3.1.jar"/>
        <get dest="${libdir}/jaf-1.0.2.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.stanford.edu/~ceyates/maven/activation/jars/jaf-1.0.2.jar"/>
        <get dest="${libdir}/saxon-B8.4-nomanifest.jar" usetimestamp="true" ignoreerrors="true"
            src="http://www.stanford.edu/~ceyates/maven/saxon/jars/saxon-B8.4-nomanifest.jar"/>
    </target>
</project>
